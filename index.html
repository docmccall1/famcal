<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Family Calendar</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700;800&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="app-shell">
    <header class="topbar">
      <div>
        <p class="eyebrow">Shared family planning</p>
        <h1>Family Calendar</h1>
      </div>
      <div class="topbar-actions">
        <button id="todayBtn" class="btn btn-secondary">Today</button>
        <button id="shareBtn" class="btn btn-primary">Copy Share Link</button>
      </div>
    </header>

    <nav class="tabbar card" id="mainTabs">
      <button class="tab-btn active" data-tab="calendar">Calendar</button>
      <button class="tab-btn" data-tab="requests">Requests</button>
      <button class="tab-btn" data-tab="chores">People & Chores</button>
      <button class="tab-btn" data-tab="planner">Date Planner</button>
      <button class="tab-btn" data-tab="meal">Meal Planner</button>
      <button class="tab-btn" data-tab="settings">Settings</button>
    </nav>

    <section class="card">
      <h3>Family Views</h3>
      <div id="personTabs" class="person-tabs"></div>
      <p class="hint">Use Family to view everything, or a person tab for individual activities and chores.</p>
    </section>

    <main id="calendarPage" class="layout page active">
      <section class="calendar-panel card">
        <div class="calendar-controls">
          <div class="date-nav">
            <button id="prevBtn" class="btn btn-secondary">◀</button>
            <h2 id="currentLabel">Month YYYY</h2>
            <button id="nextBtn" class="btn btn-secondary">▶</button>
          </div>
          <div class="view-switch">
            <button class="view-btn active" data-view="day">Day</button>
            <button class="view-btn" data-view="week">Week</button>
            <button class="view-btn" data-view="month">Month</button>
            <button class="view-btn" data-view="year">Year</button>
          </div>
        </div>
        <div id="calendarGrid" class="calendar-grid"></div>
      </section>

      <aside class="side-panel">
        <section class="card">
          <h3>Add Event</h3>
          <form id="eventForm" class="stack">
            <input type="text" id="eventTitle" placeholder="Event title" required />
            <label>
              Start Date
              <input type="date" id="eventStartDate" required />
            </label>
            <label>
              End Date
              <input type="date" id="eventEndDate" required />
            </label>
            <label class="checkbox-row">
              <input type="checkbox" id="eventAllDay" />
              <span>All day / multi-day event</span>
            </label>
            <div id="eventTimeRow" class="inline-form">
              <label>
                Start
                <input type="time" id="eventStart" />
              </label>
              <label>
                End
                <input type="time" id="eventEnd" />
              </label>
            </div>
            <label>
              Created by
              <select id="eventMember" required></select>
            </label>
            <fieldset>
              <legend>Who is involved</legend>
              <div id="eventInvolved" class="involved-grid"></div>
            </fieldset>
            <label>
              Recurrence
              <select id="eventRecurring">
                <option value="none">None</option>
                <option value="daily">Daily</option>
                <option value="weekly">Weekly</option>
                <option value="monthly">Monthly</option>
              </select>
            </label>
            <div class="row-actions">
              <button id="eventSubmitBtn" class="btn btn-primary" type="submit">Add Event</button>
              <button id="eventCancelBtn" class="btn btn-secondary hidden" type="button">Cancel Edit</button>
            </div>
          </form>
        </section>

        <section class="card">
          <h3>Recurring Activities</h3>
          <ul id="recurringList" class="list"></ul>
        </section>

      </aside>
    </main>

    <main id="requestsPage" class="page">
      <section class="layout requests-layout">
        <section class="card">
          <h2>Current Family Events</h2>
          <ul id="requestEventsList" class="list"></ul>
        </section>
        <section class="card">
          <h2>Calendar Requests</h2>
          <form id="requestForm" class="stack">
            <label>
              Request details
              <textarea id="requestInput" rows="7" placeholder="Type full request details, desired date/time, and notes" required></textarea>
            </label>
            <div class="inline-form">
              <label>
                Requested date
                <input type="date" id="requestDate" />
              </label>
              <label>
                Requested time
                <input type="time" id="requestTime" />
              </label>
            </div>
            <label>
              Requested by
              <select id="requestMember" required></select>
            </label>
            <button class="btn btn-primary" type="submit">Submit Request</button>
          </form>
        </section>
        <section class="card">
          <h2>Open Requests</h2>
          <ul id="requestList" class="list"></ul>
        </section>
      </section>
    </main>

    <main id="choresPage" class="page">
      <section class="layout chores-layout">
        <section class="card">
          <h2>Select Person</h2>
          <div id="choresPersonTabs" class="person-tabs-vertical"></div>
        </section>
        <section class="card">
          <h2>Chore List</h2>
          <p class="hint">Choose a person tab at the top to view and manage only their chores.</p>
          <form id="choreForm" class="inline-form">
            <input type="text" id="choreInput" placeholder="Add chore" required />
            <select id="choreFrequency">
              <option value="Daily">Daily</option>
              <option value="Weekly">Weekly</option>
              <option value="Monthly">Monthly</option>
            </select>
            <button class="btn btn-secondary" type="submit">Add</button>
          </form>
          <button id="generateChoresBtn" class="btn btn-primary">AI Generate Chores For Selected Tab</button>
          <p id="choreGenNote" class="hint">Select a person tab to generate chores.</p>
          <ul id="choreList" class="list chore-plan-list"></ul>
          <hr />
          <h3>Chore Game</h3>
          <p class="hint">Build a balanced weekly schedule, track points, and unlock randomizer for Game Night and Fun Night.</p>
          <div class="inline-form">
            <label>
              Week start (Mon)
              <input type="date" id="choreGameWeekStart" />
            </label>
            <label>
              Daily max chores / person
              <input type="number" id="choreDailyMax" min="1" max="6" value="2" />
            </label>
          </div>
          <div class="row-actions">
            <button id="generateWeeklyChoreGameBtn" class="btn btn-primary" type="button">Generate Weekly Chore Schedule (AI)</button>
            <button id="finalizeWeekBtn" class="btn btn-secondary" type="button">Finalize Week + Unlock Randomizer</button>
          </div>
          <div class="inline-form">
            <label>
              Daily assignment view
              <input type="date" id="choreGameDate" />
            </label>
          </div>
          <h4>Daily Assignments</h4>
          <ul id="dailyAssignmentsList" class="list"></ul>
          <h4>Weekly Load</h4>
          <ul id="weeklyLoadList" class="list"></ul>
          <h4>Weekly Leaderboard</h4>
          <ul id="gameLeaderboardList" class="list"></ul>
          <h4>Game Night and Fun Night</h4>
          <ul id="nightsList" class="list"></ul>
          <details>
            <summary>Admin Settings</summary>
            <div class="stack">
              <div class="inline-form">
                <label>
                  Point value (difficulty 1)
                  <input type="number" id="scoreDiff1" min="1" max="10" value="1" />
                </label>
                <label>
                  Point value (difficulty 2)
                  <input type="number" id="scoreDiff2" min="1" max="10" value="2" />
                </label>
                <label>
                  Point value (difficulty 3)
                  <input type="number" id="scoreDiff3" min="1" max="10" value="3" />
                </label>
              </div>
              <label class="checkbox-row">
                <input type="checkbox" id="allowReroll" checked />
                <span>Allow one reroll before confirmation</span>
              </label>
              <button id="saveGameSettingsBtn" class="btn btn-secondary" type="button">Save Game Settings</button>
            </div>
          </details>
        </section>
      </section>
    </main>

    <main id="plannerPage" class="page">
      <section class="layout planner-layout">
        <section class="card">
          <h2>AI Date Planner</h2>
          <p class="hint">Find local ideas using OpenAI. Choose one and it will auto-add to the calendar.</p>
          <form id="plannerForm" class="stack">
            <label>
              Location
              <input type="text" id="plannerLocation" placeholder="Austin, TX" required />
            </label>
            <label>
              Preferences
              <textarea id="plannerPrefs" rows="4" placeholder="Example: cozy, under $120 total, kid-free Friday nights"></textarea>
            </label>
            <label>
              Partner email
              <input type="email" id="partnerEmail" placeholder="partner@email.com" />
            </label>
            <button class="btn btn-primary" type="submit">Generate Local Date Ideas</button>
          </form>
        </section>
        <section class="card">
          <h2>Suggested Date Ideas</h2>
          <ul id="plannerIdeas" class="list"></ul>
        </section>
      </section>

    </main>

    <main id="mealPage" class="page">
      <section class="layout planner-layout">
        <section class="card">
          <h2>AI Meal Planner</h2>
          <p class="hint">Get local restaurant deals or home recipes based on people, time, and budget, including next-day ideas.</p>
          <form id="mealPlannerForm" class="stack">
            <div class="inline-form">
              <label>
                People
                <input type="number" id="mealPeople" min="1" max="20" value="4" required />
              </label>
              <label>
                Max cook time (minutes)
                <input type="number" id="mealTime" min="10" max="240" value="45" required />
              </label>
            </div>
            <div class="inline-form">
              <label>
                Budget ($)
                <input type="number" id="mealBudget" min="10" max="1000" value="80" required />
              </label>
              <label>
                Day
                <input type="date" id="mealDay" required />
              </label>
            </div>
            <div class="inline-form">
              <label>
                Mode
                <select id="mealMode">
                  <option value="EITHER">Either</option>
                  <option value="RESTAURANT">Restaurant</option>
                  <option value="RECIPE">Recipe</option>
                </select>
              </label>
              <label>
                Skill level
                <select id="mealSkill">
                  <option value="beginner">Beginner</option>
                  <option value="intermediate" selected>Intermediate</option>
                  <option value="advanced">Advanced</option>
                </select>
              </label>
            </div>
            <label>
              Location
              <input type="text" id="mealLocation" placeholder="Austin, TX" required />
            </label>
            <label>
              Dietary constraints
              <input type="text" id="mealDietary" placeholder="Vegetarian, gluten-free, etc." />
            </label>
            <label>
              Allergies
              <input type="text" id="mealAllergies" placeholder="Peanuts, shellfish, etc." />
            </label>
            <label>
              Preferred cuisines
              <input type="text" id="mealCuisines" placeholder="Italian, Mexican, etc." />
            </label>
            <label>
              Disliked ingredients
              <input type="text" id="mealDisliked" placeholder="Mushrooms, onions, etc." />
            </label>
            <label>
              Kitchen equipment
              <input type="text" id="mealEquipment" placeholder="Oven, air fryer, slow cooker..." />
            </label>
            <label>
              Preferences
              <textarea id="mealPrefs" rows="3" placeholder="Example: kid-friendly, no shellfish, lighter meals on weekdays"></textarea>
            </label>
            <button class="btn btn-primary" type="submit">Generate Meal Plan</button>
          </form>
        </section>

        <section class="card">
          <h2>Meal Suggestions</h2>
          <pre id="mealPlanText" class="plan-text"></pre>
          <h4>Restaurant Deals</h4>
          <ul id="mealDealsList" class="list"></ul>
          <h4>At-Home Recipes</h4>
          <ul id="mealRecipesList" class="list"></ul>
          <h4>Next-Day Suggestions</h4>
          <ul id="mealNextDayList" class="list"></ul>
        </section>
      </section>
    </main>

    <main id="settingsPage" class="page">
      <section class="layout settings-layout">
        <section class="card">
          <h2>Household Members</h2>
          <form id="memberForm" class="inline-form">
            <input type="text" id="memberName" placeholder="Name" required />
            <select id="memberRole" required>
              <option value="adult">Adult</option>
              <option value="child">Child</option>
            </select>
            <input type="number" id="memberAge" min="1" max="99" placeholder="Age" required />
            <select id="memberGender" required>
              <option value="girl">Girl</option>
              <option value="boy">Boy</option>
              <option value="woman">Woman</option>
              <option value="man">Man</option>
              <option value="non-binary">Non-binary</option>
            </select>
            <button class="btn btn-primary" type="submit">Add Person</button>
          </form>
          <ul id="memberList" class="list"></ul>
        </section>

        <section class="card">
          <h2>iCal Merge</h2>
          <form id="icalForm" class="stack">
            <label>
              Import into member
              <select id="icalMember" required></select>
            </label>
            <input type="file" id="icalFile" accept=".ics,.ical,text/calendar" required />
            <button class="btn btn-secondary" type="submit">Merge .ics/.ical</button>
          </form>
          <button id="exportIcalBtn" class="btn btn-primary">Export Current View .ics</button>
        </section>

        <section class="card">
          <h2>Merged Calendars</h2>
          <ul id="mergedSourcesList" class="list"></ul>
          <form id="removeOldMergedForm" class="stack">
            <label>
              Remove imported events before
              <input type="date" id="oldMergedBefore" required />
            </label>
            <label>
              Source
              <select id="oldMergedSource">
                <option value="all">All merged calendars</option>
              </select>
            </label>
            <button class="btn btn-secondary" type="submit">Remove Old Imported Events</button>
          </form>
        </section>
      </section>
    </main>
  </div>

  <script src="app.js"></script>
</body>
</html>
